define(["react","lodash","@grafana/ui","@grafana/data","@grafana/runtime"],(function(e,t,r,n,a){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=5)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t){e.exports=a},function(e,t,r){"use strict";r.r(t);var n=r(2),a=r(3),l=r(4),o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function i(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return(s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function u(e,t,r,n){return new(r||(r=Promise))((function(a,l){function o(e){try{s(n.next(e))}catch(e){l(e)}}function i(e){try{s(n.throw(e))}catch(e){l(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,i)}s((n=n.apply(e,t||[])).next())}))}function c(e,t){var r,n,a,l,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function i(l){return function(i){return function(l){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&l[0]?n.return:l[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,l[1])).done)return a;switch(n=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],n=0}finally{r=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}}function p(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,l=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=l.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=l.return)&&r.call(l)}finally{if(a)throw a.error}}return o}function f(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}var m=r(1);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var h=function(){function e(e){var t=this;this.output={columns:[],rows:[],type:"table"},e.filter((function(e){return e&&e.result&&e.result.data&&e.result.data.result})).forEach((function(e){t.query=e.query,e&&e.query&&e.query.servicenow&&"stats"===e.query.servicenow.type?e.result.data.result.stats?t.parseResultsAsSingleStat(e):t.parseResultsAsMultiStat(e):t.parseResultsAsTable(e)}))}return e.prototype.parseResultsAsSingleStat=function(e){this.output.columns.push({text:"count",type:"number"}),this.output.rows.push([Object(m.toInteger)(e.result.data.result.stats.count)])},e.prototype.parseResultsAsMultiStat=function(e){var t=this;e.result.data.result.forEach((function(r,n){if(0===n&&e&&e.query&&e.query.servicenow&&e.query.servicenow.groupBy&&(e.query.servicenow.groupBy.split(",").forEach((function(e){t.output.columns.push({text:e,type:"string"})})),t.output.columns.push({text:"count",type:"number"})),r&&r.stats){var a=Object(m.toInteger)(r.stats.count),l=[];e.query.servicenow.groupBy.split(",").forEach((function(e){var t=r.groupby_fields.find((function(t){return t.field===e}));t&&l.push(t.display_value||t.value||"-")})),l.push(a),t.output.rows.push(l)}}))},e.prototype.parseResultsAsTable=function(e){var t=this;this.output.columns=[];var r="";r=e&&e.query&&e.query.servicenow&&e.query.servicenow.fields?e.query.servicenow.fields:r,r=e&&e.query&&e.query&&e.query.fields?e.query.fields:r;var n=Object(m.uniq)(r.split(",").map((function(e){return e.trim()})).filter(Boolean));r&&"*"!==r[0]?e.result.data.result.forEach((function(e,r){0===r&&Object(m.forEach)(n,(function(e){t.output.columns.push({text:e,type:"string"})}));var a=[];t.output.columns.forEach((function(t){var r=e[t.text];"object"===d(r)&&r&&(r.display_value||""===r.value)?a.push(r.display_value||r.value):"object"===d(r)?a.push(JSON.stringify(r)):a.push(r)})),t.output.rows.push(a)})):e.result.data.result.forEach((function(e,r){0===r&&Object(m.forEach)(e,(function(e,r){"object"===d(e)&&e&&(e.display_value||""===e.value)?t.output.columns.push({text:r,type:"string"}):t.output.columns.push({text:r,type:"object"===d(e)?"string":d(e)})}));var n=[];Object(m.forEach)(e,(function(e){"object"===d(e)&&e&&(e.display_value||""===e.value)?n.push(e.display_value||e.value):"object"===d(e)?n.push(JSON.stringify(e)):n.push(e)})),t.output.rows.push(n)}))},e.prototype.getResultsAsAnnotations=function(){var e=this,t=[];return Object(m.forEach)(this.output.rows,(function(r){var n=function(e,t,r){var n={text:"",title:"",tags:[],time:(new Date).getTime()},a="";return Object(m.forEach)(t,(function(t,l){t.text===r.startTimeField?e[l]&&(n.time=new Date(e[l]).getTime(),a+=t.text+" : "+e[l]+"\n"):t.text===r.endTimeField?e[l]&&(n.timeEnd=new Date(e[l]).getTime(),a+=t.text+" : "+e[l]+"\n"):t.text===r.titleField?e[l]&&(n.title=e[l]):t.text===r.descriptionField?e[l]&&(n.text=e[l]):e[l]&&n.tags.push(t.text+" : "+e[l])})),n.text+="\n    "+a+"\n  ",n}(r,e.output.columns,e.query);t.push(n)})),t},e}(),v=function(){function e(e,t){this.key=e,this.value=t.toString()}return e.prototype.getValue=function(){return[this.key,this.value].join("=")},e}(),b=function(){function e(e,t,r,n){void 0===n&&(n="^"),this.condition=n,this.field=e,this.operator=t,this.value=r}return e.prototype.toString=function(){return(""+this.field+this.operator+this.value).trim()},e}(),y=function(){function e(e){this.table="incident",this.type="table",this.orderByDirection="asc",this.table=e.table||"incident",this.type=e.type||"table",this.fields=e.fields||"",this.query=e.query||"",this.filters=e.filters||[],this.orderByDirection=e.orderByDirection||"asc",this.orderBy=e.orderBy||"",this.groupBy=e.groupBy||"",this.limit=e.limit||25}return e.prototype.getUrl=function(){var e=[];e.push(new v("sysparm_display_value","all")),e.push(new v("sysparm_limit",this.limit||10)),this.fields&&"*"!==this.fields&&e.push(new v("sysparm_fields",this.fields||"opened_at,number,short_description,sys_created_by,severity,category,state,priority"));var t=[(this.query+"").trim().replace(/\^OR\n/g,"^OR").replace(/\^\n/g,"^").replace(/\n/g,"^")].filter(Boolean);return this.filters.forEach((function(e,r){var n=0===t.length&&0===r?"":e.condition||"^";t.push(encodeURIComponent((""+n+e.field+e.operator+e.value).trim()))})),this.orderBy&&t.push(("asc"===this.orderByDirection?"^ORDERBY":"^ORDERBYDESC")+this.orderBy.trim()),t.length>0&&e.push(new v("sysparm_query",t.join(""))),"stats"===this.type&&e.push(new v("sysparm_count","true")),"stats"===this.type&&this.groupBy&&e.push(new v("sysparm_group_by",this.groupBy.trim())),"/api/now/"+(this.type||"table")+"/"+this.table+"?"+e.map((function(e){return e.getValue()})).join("&")},e}(),g=new y({table:"incident",type:"table",fields:"opened_at,number,short_description,sys_created_by,severity,category,state,priority",query:"",groupBy:"",orderBy:"opened_at",orderByDirection:"desc",limit:10}),w=function e(t,r,n){return void 0===n&&(n=1),Object(l.getBackendSrv)().datasourceRequest({method:"GET",url:t}).catch((function(a){if(console.log(a),n>0)return e(t,r,n-1);throw a}))},E=function(e,t,r){var n="javascript:gs.dateGenerate('"+t.format("YYYY-MM-DD")+"','"+t.format("HH:mm:ss")+"')",a="javascript:gs.dateGenerate('"+r.format("YYYY-MM-DD")+"','"+r.format("HH:mm:ss")+"')";return e=(e=(e=e.replace("$__timeFrom()",n)).replace("$__timeTo()",a)).replace("$__timeFilter()",n+"@"+a)},N=function(){function e(e,t){this.instanceSettings=e,this.templateSrv=t,this.url="",this.url=this.instanceSettings.url+""}return e.prototype.doQueries=function(e,t){var r=this;return e.map((function(e){var n=e.servicenow;n&&n.query&&(n.query=E(n.query,t.range.from,t.range.to),n.query=r.templateSrv.replace(n.query,{},"glob")),n&&n.filters&&(n.filters=n.filters.map((function(e){return e.value=E(e.value,t.range.from,t.range.to),e.value=r.templateSrv.replace(e.value,{},"glob"),e})));var a=new y(n);return w(r.url+a.getUrl(),a).then((function(r){return{result:r,query:e,options:t}})).catch((function(t){throw{error:t,query:e}}))}))},e.prototype.doAnnotationQueries=function(e,t){var r=this;return e.map((function(e){e.query=E(e.query,t.range.from,t.range.to);var n=new y(e);return w(r.url+n.getUrl(),n).then((function(t){return{result:t,query:e,options:{}}})).catch((function(t){throw{error:t,query:e}}))}))},e.prototype.query=function(e){var t=[];e.targets&&(t=e.targets.filter((function(e){return!0!==e.hide})));var r=this.doQueries(t,e);return Promise.all(r).then((function(e){return new h(e).output}))},e.prototype.annotationsQuery=function(e){var t=[];if(e.targets)t=e.targets.filter((function(e){return!0!==e.hide}));else if(e.annotation){var r={limit:e.annotation.limit||30,startTimeField:e.annotation.startTimeField,endTimeField:e.annotation.endTimeField,titleField:e.annotation.titleField,descriptionField:e.annotation.descriptionField,fields:f(e.annotation.fields.split(","),[e.annotation.titleField,e.annotation.descriptionField,e.annotation.startTimeField,e.annotation.endTimeField]).filter(Boolean).join(","),query:e.annotation.query||"",table:e.annotation.table};t.push(r)}var n=this.doAnnotationQueries(t,e);return Promise.all(n).then((function(e){return new h(e).getResultsAsAnnotations()}))},e}(),_=function(e){function t(t,r){var n=e.call(this,t)||this;return n.instanceSettings=t,n.templateSrv=r,n.serviceNowDataSource=new N(n.instanceSettings,n.templateSrv),n}return t.$inject=["instanceSettings","templateSrv"],i(t,e),t.prototype.query=function(e){var t=[],r=Object(m.cloneDeep)(e);if(r.targets.length>0){var n=this.serviceNowDataSource.query(r);n&&t.push(n)}return Promise.all(t).then((function(e){return{data:Object(m.flatten)(e)}}))},t.prototype.annotationQuery=function(e){e.annotation.query=this.templateSrv.replace(e.annotation.query,{},"glob");var t={range:e.range,rangeRaw:e.rangeRaw,annotation:e.annotation};return this.serviceNowDataSource.annotationsQuery(t).then((function(e){return e})).catch((function(e){return console.error(e),[]}))},t.prototype.testDatasource=function(){var e=this;return new Promise((function(t,r){return u(e,void 0,void 0,(function(){return c(this,(function(e){return this.serviceNowDataSource.query({range:{from:"",to:""},targets:[]}).then((function(e){t({message:"Successfully Connected ServiceNow",status:"success"})})).catch((function(e){r({message:"Failed to Connect ServiceNow",status:"error"})})),[2]}))}))}))},t.prototype.metricFindQuery=function(e){return Promise.resolve([])},t}(a.DataSourceApi),S=r(0),q=r.n(S),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onURLChange=function(e){var r=t.props,n=r.onOptionsChange,a=r.options;n(s(s({},a),{url:e.target.value}))},t.onUserNameChange=function(e){var r=t.props,n=r.onOptionsChange,a=r.options;n(s(s({},a),{basicAuthUser:e.target.value}))},t.onPasswordChange=function(e){var r=t.props,n=r.onOptionsChange,a=r.options;n(s(s({},a),{secureJsonData:{basicAuthPassword:e.target.value}}))},t.onResetPassword=function(){var e=t.props,r=e.onOptionsChange,n=e.options;r(s(s({},n),{secureJsonFields:s(s({},n.secureJsonFields),{basicAuthPassword:!1}),secureJsonData:s(s({},n.secureJsonData),{basicAuthPassword:""})}))},t}return i(t,e),t.prototype.render=function(){var e=this.props.options;e.basicAuth=!0;var t=e.secureJsonFields,r=e.secureJsonData||{};return q.a.createElement(q.a.Fragment,null,q.a.createElement("h3",{className:"page-heading"},"Service Now Settings"),q.a.createElement("div",{className:"gf-form-inline"},q.a.createElement("div",{className:"gf-form"},q.a.createElement("label",{className:"gf-form-label width-11",title:"Service Now URL"},"Service Now URL"),q.a.createElement("input",{className:"gf-form-input width-20",type:"text",onChange:this.onURLChange,value:e.url||"",placeholder:"https://YOUR_INSTANCE_NAME.service-now.com"}))),q.a.createElement("div",{className:"gf-form-inline"},q.a.createElement("div",{className:"gf-form"},q.a.createElement("label",{className:"gf-form-label width-11",title:"User Name"},"User name"),q.a.createElement("input",{className:"gf-form-input width-20",type:"text",onChange:this.onUserNameChange,value:e.basicAuthUser||"",placeholder:"username"}))),q.a.createElement("div",{className:"gf-form-inline"},q.a.createElement("div",{className:"gf-form"},q.a.createElement("label",{className:"gf-form-label width-11",title:"Password"},"Password"),t&&t.basicAuthPassword?q.a.createElement(q.a.Fragment,null,q.a.createElement("label",{className:"gf-form-label width-20"},"Configured"),q.a.createElement("span",{className:"gf-form-button btn btn-secondary width-6",onClick:this.onResetPassword},"Reset")):q.a.createElement("input",{type:"password",value:r.basicAuthPassword||"",className:"gf-form-input width-20",onChange:this.onPasswordChange}))))},t}(S.PureComponent),T=function(e,t,r){var n=r.query,a=r.onChange,l=n.servicenow;Object(m.set)(l,t,e.value),a(s(s({},n),{servicenow:l}))},O=function(e,t,r){var n=r.query,a=r.onChange,l=n.servicenow;Object(m.set)(l,t,e.target.value),a(s(s({},n),{servicenow:l}))},A="annotations/annotations.editor.html",R=[{label:"Incidents (INC)",value:"incident",short_code:"INC"},{label:"Change Request (CHG)",value:"change_request",short_code:"CHG"},{label:"Problem (PRB)",value:"problem",short_code:"PRB"},{label:"System User Group",value:"sys_user_group",short_code:""}],F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={showHelpModal:!1},t.showHelpModal=function(e){return function(){t.setState({showHelpModal:e})}},t}return i(t,e),t.prototype.render=function(){var e=this.state.showHelpModal;return q.a.createElement(q.a.Fragment,null,"  ",q.a.createElement("button",{onClick:this.showHelpModal(!0),title:"Help",className:"btn btn-secondary btn-small"},"service now query help"),q.a.createElement(n.Modal,{title:q.a.createElement("div",{className:"modal-header-title"},q.a.createElement("span",{className:"p-l-1"},"Service Now Query Help")),isOpen:e,onDismiss:this.showHelpModal(!1)},q.a.createElement("div",null,q.a.createElement("div",null,q.a.createElement("h4",null,"Time Filter"),q.a.createElement("br",null),q.a.createElement("pre",{style:{display:"inline"}},"$__timeFrom()")," Returns the From datetime from the Grafana picker. Can be used with"," ",q.a.createElement("b",null,"Before / After")," filter.",q.a.createElement("br",null),q.a.createElement("br",null),q.a.createElement("pre",{style:{display:"inline"}},"$__timeTo()")," Returns the To datetime from the Grafana picker. Can be used with"," ",q.a.createElement("b",null,"Before / After")," filter.",q.a.createElement("br",null),q.a.createElement("br",null),q.a.createElement("pre",{style:{display:"inline"}},"$__timeFilter()")," Return start and end time form Grafana picker. Can be used with ",q.a.createElement("b",null,"Between")," ","filter.",q.a.createElement("br",null),q.a.createElement("br",null),q.a.createElement("h4",null,"Relative Time"),q.a.createElement("br",null),q.a.createElement("pre",{style:{display:"inline"}},"@hour@ago@24")," Returns the timestamp of 24 hours ago. Can be used with ",q.a.createElement("b",null,"Relative")," filter.",q.a.createElement("br",null),q.a.createElement("br",null),q.a.createElement("pre",{style:{display:"inline"}},"@hour@ago@-24")," Returns the timestamp of 24 hours from now. Can be used with ",q.a.createElement("b",null,"Relative")," ","filter.",q.a.createElement("br",null),q.a.createElement("br",null),q.a.createElement("p",null,"More help can be found at"," ",q.a.createElement("a",{href:"https://docs.servicenow.com/bundle/orlando-platform-user-interface/page/use/common-ui-elements/reference/r_OpAvailableFiltersQueries.html",target:"_blank",rel:"noopener"},"service-now website."))))))},t}(S.PureComponent),B=R,D=[{label:"Table",value:"table"},{label:"Stats",value:"stats"}],x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e=this,t=this.props.query;return q.a.createElement("div",null,q.a.createElement("div",{className:"gf-form-inline"},q.a.createElement("div",{className:"gf-form"},q.a.createElement("label",{className:"gf-form-label query-keyword width-8"},"Table"),q.a.createElement(n.Select,{className:"width-12",value:B.find((function(e){return e.value===t.servicenow.table}))||{label:t.servicenow.table,value:t.servicenow.table},options:B,defaultValue:t.servicenow.table,onChange:function(t){return T(t,"table",e.props)},allowCustomValue:!0})),q.a.createElement("div",{className:"gf-form"},q.a.createElement("label",{className:"gf-form-label query-keyword width-6"},"Type"),q.a.createElement(n.Select,{className:"width-12",value:D.find((function(e){return e.value===t.servicenow.type})),options:D,defaultValue:t.servicenow.type,onChange:function(t){return T(t,"type",e.props)}}),q.a.createElement(F,null))))},t}(S.PureComponent),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e=this,t=this.props.query;return q.a.createElement("div",null,q.a.createElement("div",{className:"gf-form-inline"},q.a.createElement("div",{className:"gf-form"},q.a.createElement("label",{className:"gf-form-label width-8",title:"Fields ( Comma separated )"},"Fields"),q.a.createElement("input",{className:"gf-form-input width-30",type:"text",onChange:function(t){return O(t,"fields",e.props)},value:t.servicenow.fields,placeholder:"Fields ( Comma Separated)",title:"Fields ( Comma Separated )"}))))},t}(S.PureComponent),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e=this,t=this.props.query;return q.a.createElement("div",null,q.a.createElement("div",{className:"gf-form-inline"},q.a.createElement("div",{className:"gf-form"},q.a.createElement("label",{className:"gf-form-label width-8",title:"Query"},"Query"),q.a.createElement("textarea",{value:t.servicenow.query||"",onChange:function(t){return O(t,"query",e.props)},className:"gf-form-input min-width-30 width-30",rows:3}))))},t}(S.PureComponent),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e=this,t=this.props.query;return q.a.createElement("div",null,q.a.createElement("div",{className:"gf-form-inline"},q.a.createElement("div",{className:"gf-form"},q.a.createElement("label",{className:"gf-form-label width-8",title:"Group By Field"},"Group By"),q.a.createElement("input",{className:"gf-form-input width-30",type:"text",onChange:function(t){return O(t,"groupBy",e.props)},value:t.servicenow.groupBy,placeholder:"",title:"Group By"}))))},t}(S.PureComponent),L=[{value:"active",label:"Active",tables:["incident","change_request","problem"]},{value:"assigned_to",label:"Assigned To",tables:["incident","change_request","problem"]},{value:"assignment_group.name",label:"Assignment Group",tables:["incident","change_request","problem"]},{value:"assignment_group",label:"Assignment Group ID",tables:["incident","change_request","problem"]},{value:"description",label:"Description",tables:["incident","change_request","problem","sys_user_group"]},{value:"end_date",label:"End Date",tables:["change_request"]},{value:"incident_state",label:"Incident State",tables:["incident"]},{value:"number",label:"Number",tables:["incident","change_request","problem"]},{value:"opened_at",label:"Opened At",tables:["incident","change_request","problem"]},{value:"priority",label:"Priority",tables:["incident","change_request","problem"]},{value:"short_description",label:"Short Description",tables:["incident","change_request","problem"]},{value:"start_date",label:"Start Date",tables:["change_request"]},{value:"state",label:"State",tables:["incident","change_request","problem"]},{value:"sys_created_by",label:"Created By",tables:["incident","change_request","problem"]},{value:"sys_created_on",label:"Created On",tables:["incident","change_request","problem"]},{value:"urgency",label:"Urgency",tables:["problem"]},{value:"category",label:"Category",tables:["problem"]},{value:"subcategory",label:"Subcategory",tables:["problem"]},{value:"name",label:"Name",tables:["sys_user_group"]},{value:"manager",label:"Manager",tables:["sys_user_group"]},{value:"email",label:"Email",tables:["sys_user_group"]}],G=[{label:"Ascending",value:"asc"},{label:"Descending",value:"desc"}],M=[10,25,50,100,250,500,1e3].map((function(e){return{label:e.toString(),value:e.toString()}})),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e=this,t=this.props.query;return q.a.createElement("div",null,q.a.createElement("div",{className:"gf-form-inline"},q.a.createElement("div",{className:"gf-form"},q.a.createElement("label",{className:"gf-form-label width-8",title:"Order By"},"Order By"),q.a.createElement(n.Select,{className:"width-12",value:L.find((function(e){return e.value===t.servicenow.orderBy}))||{value:t.servicenow.orderBy,label:t.servicenow.orderBy},options:L.filter((function(e){return e.tables.indexOf(t.servicenow.table)>-1})),defaultValue:t.servicenow.orderBy,onChange:function(t){return T(t,"orderBy",e.props)},allowCustomValue:!0}),q.a.createElement("label",{className:"gf-form-label width-8",title:"Order Direction"},"Order Direction"),q.a.createElement(n.Select,{className:"width-8",value:G.find((function(e){return e.value===t.servicenow.orderByDirection})),options:G,defaultValue:t.servicenow.orderByDirection,onChange:function(t){return T(t,"orderByDirection",e.props)}}),q.a.createElement("label",{className:"gf-form-label width-3",title:"Limit"},"Limit"),q.a.createElement(n.Select,{className:"width-5",value:M.find((function(e){return e.value===t.servicenow.limit}))||{value:t.servicenow.limit,label:t.servicenow.limit},options:M,defaultValue:t.servicenow.limit,onChange:function(t){return T(t,"limit",e.props)},allowCustomValue:!0}))))},t}(S.PureComponent),k=[{value:"=",label:"Equals"},{value:"!=",label:"Not Equals"},{value:"<",label:"Less than"},{value:"<=",label:"Less than or Equals"},{value:">",label:"Greater than"},{value:">=",label:"Greater than or Equals"},{value:"STARTSWITH",label:"Starts With"},{value:"ENDSWITH",label:"Ends With"},{value:"LIKE",label:"Like"},{value:"NOTLIKE",label:"Not Like"},{value:"ISEMPTY",label:"Is Empty"},{value:"ISNOTEMPTY",label:"Is Not Empty"},{value:"IN",label:"In"},{value:"NOT IN",label:"Not In"},{value:"ANYTHING",label:"Anything"},{value:"BETWEEN",label:"Between"},{value:"SAMEAS",label:"Is Same"},{value:"NSAMEAS",label:"Is Different"},{value:"ONToday",label:"On Today"},{value:"NOTONToday",label:"NOT ON Today"},{value:"DATEPART",label:"Date Part"},{value:"RELATIVEGE",label:"Relative (on or after)"},{value:"RELATIVELE",label:"Relative (on or before)"},{value:"RELATIVEGT",label:"Relative (after)"},{value:"RELATIVELT",label:"Relative (before)"},{value:"RELATIVEEE",label:"Relative (on)"},{value:"MORETHAN",label:"Is More than"},{value:"LESSTHAN",label:"Is Less than"},{value:"GT_FIELD",label:"Greater than field"},{value:"LT_FIELD",label:"Less than field"},{value:"GT_OR_EQUALS_FIELD",label:"Greater than or is field"},{value:"LT_OR_EQUALS_FIELD",label:"Less than or is field"}],V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onFilterAdd=function(e){void 0===e&&(e="^");var r=t.props,n=r.query,a=r.onChange,l=n.servicenow,o=R.find((function(e){return e.value===l.table})),i=new b("number","STARTSWITH",o?o.short_code:"CHG",e);l.filters=l.filters||[i],l.filters.push(i),a(s(s({},n),{servicenow:l}))},t.onFilterRemove=function(e){var r=t.props,n=r.query,a=r.onChange,l=n.servicenow,o=R.find((function(e){return e.value===l.table})),i=new b("number","STARTSWITH",o?o.short_code:"CHG");l.filters=l.filters||[i],l.filters.splice(e,1),a(s(s({},n),{servicenow:l}))},t}return i(t,e),t.prototype.render=function(){var e=this,t=this.props.query;return q.a.createElement("div",null,0===t.servicenow.filters.length?q.a.createElement("div",{className:"gf-form-inline"},q.a.createElement("div",{className:"gf-form"},q.a.createElement("div",{className:"gf-form gf-form--grow"},q.a.createElement("label",{className:"gf-form-label width-8",title:"Filter"},"Filter"))),q.a.createElement("div",{className:"gf-form"},q.a.createElement("div",{className:"gf-form gf-form--grow"},q.a.createElement("span",{className:"btn btn-success btn-small",style:{margin:"5px"},onClick:function(){return e.onFilterAdd("^")}},"Add Filter")))):null,t.servicenow.filters.map((function(r,a){return q.a.createElement("div",{className:"gf-form-inline"},q.a.createElement("div",{className:"gf-form"},q.a.createElement("div",{className:"gf-form gf-form--grow"},q.a.createElement("label",{className:"gf-form-label width-8",title:"Filter"},"Filter ",a+1))),q.a.createElement("div",{className:"gf-form"},q.a.createElement("div",{className:"gf-form gf-form--grow"},q.a.createElement(n.Select,{className:"width-12",value:L.find((function(e){return e.value===r.field}))||{value:r.field,label:r.field},options:L.filter((function(e){return e.tables.indexOf(t.servicenow.table)>-1})),defaultValue:r.field,onChange:function(t){return T(t,"filters["+a+"].field",e.props)},allowCustomValue:!0}),q.a.createElement(n.Select,{className:"width-12",value:k.find((function(e){return e.value===r.operator}))||{value:r.operator,label:r.operator},options:k,defaultValue:r.operator,onChange:function(t){return T(t,"filters["+a+"].operator",e.props)},allowCustomValue:!0}),q.a.createElement("input",{type:"text",className:"gf-form-input width-12",title:"Value",placeholder:"Value",value:r.value,onChange:function(t){return O(t,"filters["+a+"].value",e.props)}}))),q.a.createElement("span",null,q.a.createElement("div",{className:"gf-form"},q.a.createElement("div",{className:"gf-form gf-form--grow"},a===t.servicenow.filters.length-1?q.a.createElement("span",{className:"btn btn-success btn-small",style:{margin:"5px"},onClick:function(){return e.onFilterAdd("^")}},"+"):null,q.a.createElement("span",{className:"btn btn-danger btn-small",style:{margin:"5px"},onClick:function(){return e.onFilterRemove(a)}},"x")))))})))},t}(S.PureComponent),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e,t=Object(m.defaults)(this.props.query,{servicenow:Object(m.defaults)(this.props.query.servicenow,g)});if(t&&t.servicenow&&t.servicenow.type)switch(t.servicenow.type){case"table":e=q.a.createElement(P,{onChange:this.props.onChange,query:t,datasource:this.props.datasource});break;case"stats":e=q.a.createElement(I,{onChange:this.props.onChange,query:t,datasource:this.props.datasource})}return q.a.createElement("div",null,q.a.createElement(x,{onChange:this.props.onChange,query:t,datasource:this.props.datasource}),e,q.a.createElement(j,{onChange:this.props.onChange,query:t,datasource:this.props.datasource}),q.a.createElement(V,{onChange:this.props.onChange,query:t,datasource:this.props.datasource}),q.a.createElement(H,{onChange:this.props.onChange,query:t,datasource:this.props.datasource}))},t}(S.PureComponent),Q=function(){function e(){this.supportedTables=R.map((function(e){return{text:e.label,value:e.value}}))}return e.templateUrl=A,e}();r.d(t,"plugin",(function(){return Y}));var Y=new a.DataSourcePlugin(_).setConfigEditor(C).setQueryEditor(U).setAnnotationQueryCtrl(Q)}])}));